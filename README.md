# Section 3: ML API

Deploy (on a cloud provider [AWS, Azure, etc] or locally [docker, kubernetes, etc] ) an ML model ([MNIST](https://paperswithcode.com/dataset/mnist), [Fashion MNIST](https://github.com/zalandoresearch/fashion-mnist), as an API endpoint. Provide reproducible code with documentation for both deployment and usage.

## Introduction

This code deploys a machine learning model as a lambda function.

## Steps:

1. Set up the working environment by integrating AWS CLI on our machine and initialize a S3 bucket as a data store.
2. Train a K-Nearest Neighbor classifier which we will deploy as a docker container
3. Deploy as a lambda function with AWS SAM

See README-predict-app-api for more information

## API Endpoint:

https://b6lornzdwgu54gjsy2zaryoux40fxfxn.lambda-url.us-west-1.on.aws/

Note: This API is set to public access and its Function URL does not require AWS IAM roles or security

## Folder Structure:

```bash
.
├── Dockerfile                      # Docker image definition for Python process
├── README-predict-app-api.html     # HTML of Jupyter notebook
├── README-predict-app-api.ipynb    # Jupyter notebook with code and explanation
├── README.md                       # This file
├── app
│   ├── knnclf.joblib               # Trained KNN model
│   └── lambda_predict.py           # Code to run in Lambda (load data, predict, return NumPy array)
├── overview.png
├── poetry.lock                     # More requirements for Python
├── pyproject.toml                  # Generated by AWS SAM
├── requirements.txt                # For Python in Docker image
├── samconfig.toml                  # Generated by AWS SAM
└── template.yaml                   # Code for building serverless application
```

##Conclusion:

This API reads test images from MNIST that are stored in the S3 bucket and uses the trained KNN classifier to predict the numbers.  HOWEVER, it does not take in new images.  I tried to write another API to upload 28x28 images to S3 to be read by this predict-app API but was unsuccessful in using Lambda to upload the file and convert to NumPy Array / Pandas DataFrame because of layers limitations in Lambda.
